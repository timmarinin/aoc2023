input â† â€¢FChars "./input_5.txt"
SplitIndices â† (âŠ¢-Ëœ+`Ã—Â¬)âŠ¸âŠ”  # from bqncrate: split ğ•© word at indices indicated by ğ•¨
nl â† @+10
Split â† ((Â¬-ËœâŠ¢Ã—Â·+`Â»âŠ¸>)âˆ˜â‰ âŠ”âŠ¢) # from bqncrate
Search â† (â‰  âˆ˜ âŠ¢ â†‘ â·) # from bqncrate
SortRanges â† ((â‹1âŠ¸âŠ‘Â¨ ) âŠ âŠ¢) # sort by second column
CanIndex â† {
    res â† ğ•¨ ((0âŠ¸â‰¤)Ëœâˆ§<) ğ•©
    # â€¢Show res
 } # can ğ•¨ index ğ•©
InPair â† { # w to check, x pair
    (ğ•¨ - 0âŠ‘ğ•©) CanIndex 1âŠ‘ğ•©
}
ParseMap â† { â€¢ParseFloatÂ¨Â¨ ' ' SplitÂ¨ ğ•© }
#          dest source len
idRange â† âŸ¨0,   0,     0âŸ©


parts â† nlâŠ¸SplitÂ¨ (âŸ¨nl, nlâŸ© Search input) SplitIndices input
seedsLine â† âŠ‘âŠ‘ parts

# Part1 seeds are given as-is
seeds â† â€¢ParseFloatÂ¨ ({(' 'âŠ¸Split (â‰  "seeds: ") â†“ ğ•©)} (âŠ‘âŠ‘ parts))
maps â† 1âŠ¸â†“Â¨(1â†“parts)

Transform â† { (ğ•¨ - 1âŠ¸âŠ‘ğ•©) + 0âŠ‘ğ•© } # w - number, x - range
ApplicableRange â† { âŠ‘ (((ğ•¨ { (ğ•¨ - 1âŠ¸âŠ‘ğ•©) }Â¨ ğ•©) CanIndexÂ¨ 2âŠ‘Â¨ğ•©)/ğ•©) âˆ¾ âŸ¨idRangeâŸ© }
ApplyTransform2 â† { ğ•¨ (âŠ£ Transform ApplicableRange)âŒœ <ğ•© }
RunTransforms â† { Â¯1 âŠ‘ ApplyTransform2` (âŸ¨ğ•©âŸ© âˆ¾ (ParseMapÂ¨ maps)) }

part1 â† âŒŠÂ´ RunTransforms seeds
# â€¢Show "Part 1: "â€¿part1

# PART 2
pairCount â† (â‰ seeds) Ã· 2
pairs â† <Ë˜ (pairCountâ€¿2) â¥Š seeds

Range2points â† {
    destâ€¿sourceâ€¿len â† ğ•©
    â·âˆ§âŸ¨source, source + lenâŸ©
}

maps2 â† ( ParseMapÂ¨ (â¥Šmaps))
InvertMap â† { {1â€¿0â€¿2 âŠ ğ•© }Â¨ ğ•© }
MergeMaps â† {
    left â† ğ•© â‹„ right â† ğ•¨
    leftI â† InvertMap left
    lpoints â† â· âˆ§ âˆ¾ Range2pointsÂ¨ left
    rpoints â† â· âˆ§ âˆ¾ Range2pointsÂ¨ right
    rpointsInL â† rpoints ApplyTransform2 leftI
    
    poi â† â· âˆ§ (lpoints âˆ¾ rpointsInL)
    poiInLR â† (poi ApplyTransform2 left) ApplyTransform2 right
    lens â† -ËœËË˜ (2â†• (poi âˆ¾ (âŒˆÂ´poi)))
    
    newPairs â† SortRanges poi â‹ˆËœÂ¨ poiInLR
    newRanges â† SortRanges (newPairs âˆ¾Â¨ lens)
    
    # verify that merged map works
    !âˆ§Â´({
        x â† ğ•©
        original â† (x ApplyTransform2 left) ApplyTransform2 right
        merged â† x ApplyTransform2 newRanges
        âŠ‘ original=merged
    }Â¨ poi )

    newRanges
}

merged â† (MergeMapsÂ´ (âŒ½maps2))
invertMerged â† SortRanges InvertMap merged
destinations â† 1âŠ‘Â¨ invertMerged
starts â† destinations ApplyTransform2 invertMerged
matches â† { âˆ¨Â´ ğ•© InPairâŒœ pairs }Â¨ starts
paired â† matches / starts
pairedD â† matches / destinations
â€¢Show âŠ‘ pairedD